<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gi·∫£i c·ª©u h·ªçc sinh kh·ªèi t·ªß l·∫°nh</title>
<style>
body { margin:0; font-family: Arial, sans-serif; text-align:center; overflow:hidden; }
#startScreen, #endScreen {
    position: absolute;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: url('assets/background.png') no-repeat center/cover;
}
#gameScreen { display:none; background: url('assets/background.png') no-repeat center/cover; width:100%; height:100vh; position:relative; }
#fridgeContainer { position:relative;transform: scale(1.2); width:500px; height:400px; margin:20px auto; background:url('assets/fridge.png') no-repeat center/cover; }
.student { width:60px; height:60px; position:absolute; bottom:150px; transition: all 0.5s ease; }
#heatBar { width:300px; height:20px; border:2px solid #000; margin:10px auto; position:relative; }
#heatFill { height:100%; width:0%; background-color:#00ff00; transition: width 0.3s, background-color 0.3s; }
#codes { margin:10px; font-size:18px; color:#fff; text-shadow:1px 1px #000; }
.question { margin:20px; font-size:20px; color:#fff; text-shadow:1px 1px #000; }
.answers button { margin:5px; padding:10px 20px; font-size:16px; cursor:pointer; }
.frozen { filter: brightness(50%) grayscale(80%) blur(1px); }
#snowflake { position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:1000; }
.snow { position:absolute; width:10px; height:10px; background:white; border-radius:50%; opacity:0.8; animation:fall linear infinite; }
@keyframes fall { 0% { transform: translateY(-10px); } 100% { transform: translateY(100vh); } }
@keyframes shake { 0% { transform: translateX(0px); } 25% { transform: translateX(-5px); } 50% { transform: translateX(5px); } 75% { transform: translateX(-5px); } 100% { transform: translateX(0px); } }
@keyframes jump { 0% { bottom:50px; } 50% { bottom:150px; } 100% { bottom:50px; } }
</style>
</head>
<body>

<!-- Start Screen -->
<div id="startScreen">
    <h1>Gi·∫£i c·ª©u h·ªçc sinh kh·ªèi t·ªß l·∫°nh!</h1>
    <div style="
        max-width:500px; 
        margin:20px auto; 
        padding:15px 20px; 
        background: rgba(0,0,0,0.4); /* n·ªÅn b√°n trong su·ªët */
        backdrop-filter: blur(5px); /* m·ªù n·ªÅn ph√≠a sau */
        border-radius:15px; 
        text-align:center; 
        color:white; 
        font-size:16px; 
        line-height:1.5;
        box-shadow: 0 0 10px rgba(0,0,0,0.5);
    ">
        ‚ùÑÔ∏è Gi√∫p h·ªçc sinh b·ªã k·∫πt trong t·ªß l·∫°nh tho√°t ra!<br>
        ‚úÖ Ch·ªçn h·ªçc sinh v√† tr·∫£ l·ªùi c√¢u h·ªèi ƒë√∫ng ƒë·ªÉ c·ª©u.<br>
        ‚ö†Ô∏è Tr·∫£ l·ªùi sai ‚Üí h·ªçc sinh ƒë√≥ng bƒÉng v√† tuy·∫øt r∆°i nhi·ªÅu h∆°n.<br>
        üéØ C·ª©u c√†ng nhi·ªÅu h·ªçc sinh c√†ng t·ªët tr∆∞·ªõc khi b·ªã ƒë√≥ng bƒÉng ho√†n to√†n!
    </div>
    <button onclick="startGame()">B·∫Øt ƒë·∫ßu</button>
</div>
<!-- Ice Overlay -->
<div id="iceOverlay" style="
    position:absolute;
    top:0; left:0;
    width:80px; height:100%;
    pointer-events:none;
    background:url('assets/ice.png') no-repeat right/cover;
    z-index:50;
    opacity:0.8;
    filter: blur(2px);
    transition: width 1s linear;
"></div>
<!-- Game Screen -->
<div id="gameScreen">
    <div id="fridgeContainer">
        <img src="assets/student1.png" id="student1" class="student" style="left:103px;">
        <img src="assets/student2.png" id="student2" class="student" style="left:162px;">
        <img src="assets/student3.png" id="student3" class="student" style="left:224px;">
        <img src="assets/student4.png" id="student4" class="student" style="left:283px;">
        <img src="assets/student5.png" id="student5" class="student" style="left:337px;">
    </div>
    <div id="heatBar"><div id="heatFill"></div></div>
    <div id="codes">S·ªë code ƒë√£ thu th·∫≠p: 0/5</div>
    <div class="question" id="question"></div>
    <div class="answers" id="answers"></div>
    <div id="timer">Th·ªùi gian c√≤n l·∫°i: <span id="time">10</span>s</div>
</div>

<!-- Snow effect -->
<div id="snowflake"></div>

<!-- End Screen -->
<div id="endScreen" style="display:none;">
    <h1 id="endMessage"></h1>
    <button onclick="location.reload()">Ch∆°i l·∫°i</button>
</div>

<!-- Sounds -->
<audio id="tick" src="assets/tick.mp3"></audio>
<audio id="success" src="assets/success.mp3"></audio>
<audio id="fail" src="assets/fail.mp3"></audio>
<audio id="openDoor" src="assets/openDoor.mp3"></audio>
<audio id="bgm" src="assets/bgm.mp3" loop></audio>
<audio id="winSound" src="assets/win.mp3"></audio>
<audio id="loseSound" src="assets/lose.mp3"></audio>
<script>
    // ----------------------------
// D·ªÆ LI·ªÜU C√ÇU H·ªéI CHO T·ª™NG STUDENT
// ----------------------------
const questions = [
    {q:"Th·ª©c ƒÉn ch∆∞a s·ª≠ d·ª•ng xong n√™n l√†m g√¨?", a:["ƒê·ªï v√†o th√πng r√°c","C·∫•t v√†o t·ªß l·∫°nh","V·ª©t ra ngo√†i ƒë∆∞·ªùng","ƒê·ªï xu·ªëng c·ªëng"], correct:1},
    {q:"T·ªß l·∫°nh c√≥ ch·ª©c nƒÉng ch√≠nh l√† g√¨?", a:["B·∫£o qu·∫£n th·ª±c ph·∫©m","L√†m kem","S·∫•y kh√¥ ƒë·ªì","L√†m n√≥ng th·ª±c ph·∫©m"], correct:0},
    {q:"T·ªß l·∫°nh th∆∞·ªùng c√≥ m·∫•y ngƒÉn?", a:["Kh√¥ng c√≥","M·ªôt","Hai","Ba"], correct:2},
    {q:"T·∫°i sao kh√¥ng n√™n m·ªü c·ª≠a t·ªß l·∫°nh l√¢u?", a:["T·ªën ƒëi·ªán","L√†m h∆∞ ngay","Kh√¥ng ·∫£nh h∆∞·ªüng","G√¢y ti·∫øng ·ªìn"], correct:0},
    {q:"Kem b·∫£o qu·∫£n ·ªü ngƒÉn n√†o?", a:["NgƒÉn rau","NgƒÉn ƒë√°","NgƒÉn l√†m l·∫°nh","C·ª≠a t·ªß"], correct:1}
];

// ----------------------------
// BI·∫æN H·ªÜ TH·ªêNG
// ----------------------------
const students = document.querySelectorAll('.student');

const qBox = document.getElementById('question');
const ansBox = document.getElementById('answers');

let currentStudent = null;
let savedCount = 0;
let frozenCount = 0;

let timeLeft = 10; // th·ªùi gian cho m·ªói c√¢u h·ªèi
let timer;
let snowInterval;

// ----------------------------
// START GAME
// ----------------------------
function startGame() {
    document.getElementById("startScreen").style.display = "none";
    document.getElementById("gameScreen").style.display = "block";
    document.getElementById("bgm").play();
}

// ----------------------------
// CH·ªåN STUDENT ƒê·ªÇ H·ªéI
// ----------------------------
students.forEach((stu, index) => {
    stu.dataset.state = "alive";

    stu.addEventListener("click", () => {
        if (stu.dataset.state !== "alive") return;
        currentStudent = index;
        showQuestion(index);
    });
});

// ----------------------------
// HI·ªÜN C√ÇU H·ªéI
// ----------------------------
function showQuestion(i) {
    const q = questions[i];
    qBox.innerText = q.q;

    ansBox.innerHTML = "";
    q.a.forEach((ans, idx) => {
        let btn = document.createElement("button");
        btn.innerText = ans;
        btn.onclick = () => checkAnswer(idx);
        ansBox.appendChild(btn);
    });

    qBox.style.display = "block";
    ansBox.style.display = "block";

    startTimerForStudent(); // b·∫Øt ƒë·∫ßu 10s cho h·ªçc sinh n√†y
}

// ----------------------------
// CHECK ƒê√öNG / SAI
// ----------------------------
function checkAnswer(ans) {
    clearInterval(timer); // d·ª´ng timer khi tr·∫£ l·ªùi

    const q = questions[currentStudent];

    if (ans === q.correct) {
        saveStudent(currentStudent);
        document.getElementById('success').play();
    } else {
        freezeStudent(currentStudent);
        document.getElementById('fail').play();
    }

    qBox.style.display = "none";
    ansBox.style.display = "none";

    currentStudent = null; // ch∆∞a ch·ªçn student
    checkGameEnd();
}

// ----------------------------
// C·ª®U STUDENT (JUMP)
// ----------------------------
function saveStudent(i) {
    let st = students[i];
    st.dataset.state = "saved";
    savedCount++;

    st.style.animation = "jump 0.6s ease";
    setTimeout(() => st.style.bottom = "400px", 500);
    setTimeout(() => st.style.display = "none", 900);
}

// ----------------------------
// ƒê√ìNG BƒÇNG STUDENT SAI
// ----------------------------
function freezeStudent(i) {
    let st = students[i];
    st.dataset.state = "frozen";
    frozenCount++;

    st.classList.add("frozen");

    const ice = document.createElement("div");
    ice.style.position = "absolute";
    ice.style.top = st.offsetTop + "px";
    ice.style.left = st.offsetLeft + "px";
    ice.style.width = "78px";
    ice.style.height = st.offsetHeight + "px";
    ice.style.background = "url('assets/ice.png') center/cover no-repeat";
    ice.style.opacity = "1";
    ice.style.zIndex = "100";
    document.getElementById("fridgeContainer").appendChild(ice);

    // b·∫Øt ƒë·∫ßu snow n·∫øu ch∆∞a ch·∫°y
    if (!snowInterval) startSnow();
}

// ----------------------------

// ----------------------------
// KI·ªÇM TRA K·∫æT TH√öC GAME
// ----------------------------
function checkGameEnd() {
    // N·∫øu t·∫•t c·∫£ h·ªçc sinh ƒë√£ ƒë∆∞·ª£c tr·∫£ l·ªùi (saved + frozen = t·ªïng s·ªë h·ªçc sinh)
    if (savedCount + frozenCount === students.length) {
        endGame(savedCount); // truy·ªÅn s·ªë h·ªçc sinh ƒë√£ c·ª©u
    }
}


// ----------------------------
// END GAME
// ----------------------------
function endGame(saved) {
    document.getElementById('gameScreen').style.display = "none";
    document.getElementById('endScreen').style.display = "flex";

    const msg = document.getElementById('endMessage');

    // T·∫°o n·ªôi dung trong √¥ ch·ªØ nh·∫≠t n·ªÅn m·ªù
    let content = "";

    if (saved === students.length) {
        content = `üéâCh√∫c m·ª´ng b·∫°n ƒë√£ c·ª©u ƒë∆∞·ª£c t·∫•t c·∫£ h·ªçc sinh!`;
        document.getElementById('winSound').play();
    } else {
        content = `‚ùÑÔ∏è B·∫°n ƒë√£ c·ª©u ƒë∆∞·ª£c ${saved} h·ªçc sinh.`;
        document.getElementById('loseSound').play();
    }

    msg.innerHTML = `
        <div style="
            max-width:500px; 
            margin:20px auto; 
            padding:15px 20px; 
            background: rgba(0,0,0,0.4); 
            backdrop-filter: blur(5px); 
            border-radius:15px; 
            text-align:center; 
            color:white; 
            font-size:16px; 
            line-height:1.5;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
        ">
            ${content}
        </div>
    `;
}



// ----------------------------
// TIMER CHO M·ªñI H·ªåC SINH
// ----------------------------
function startTimerForStudent() {
    clearInterval(timer);
    timeLeft = 10;
    document.getElementById('time').innerText = timeLeft;

    timer = setInterval(() => {
        if (currentStudent === null) return; // ch∆∞a ch·ªçn student
        timeLeft--;
        document.getElementById('time').innerText = timeLeft;

        if (timeLeft <= 0) {
            clearInterval(timer);
            if (currentStudent !== null) {
                freezeStudent(currentStudent);
                document.getElementById('fail').play();
                qBox.style.display = ansBox.style.display = "none";
                currentStudent = null;
                checkGameEnd();
            }
        }
    }, 1000);
}

// ----------------------------
// HI·ªÜU ·ª®NG TUY·∫æT
// ----------------------------
function startSnow() {
    const snowflake = document.getElementById('snowflake');
    snowInterval = setInterval(() => {
        const snow = document.createElement('div');
        snow.classList.add('snow');
        snow.style.left = Math.random() * 100 + '%';
        snow.style.animationDuration = (2 + Math.random() * 3) + 's';
        snowflake.appendChild(snow);
        setTimeout(() => snow.remove(), 5000);
    }, 200);
}

</script>




</body>
</html>
